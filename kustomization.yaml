namespace: cached-local-path-storage
namePrefix: cached-

resources:
- github.com/rancher/local-path-provisioner/deploy?ref=v0.0.17

patchesStrategicMerge:
- operator-patch.yaml
- storageclass-patch.yaml

configMapGenerator:
- name: local-path-config
  namespace: local-path-storage
  behavior: replace
  files:
  - config/config.json
  - config/setup
  - config/teardown

generatorOptions:
  disableNameSuffixHash: true

# Workaround the fact that namePrefix / nameSuffix also adds a prefix to the base namespace. Issue: https://github.com/kubernetes-sigs/kustomize/issues/235#issuecomment-522887625. Workaround: https://github.com/kubernetes-sigs/kustomize/issues/235#issuecomment-430197657
patchesJson6902:
- target:
    version: v1
    kind: Namespace
    name: local-path-storage
  path: namespace-patch.yaml
